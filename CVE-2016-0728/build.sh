#!/bin/sh

#LINUX_VER_FLAG=-DLINUX_VER_4
LINUX_VER_FLAG=

SMEP_FLAG=-DBYPASS_SMEP
#SMEP_FLAG=

#CC_PREFIX=aarch64-linux-gnu-
CC_PREFIX=

#TEST_LKM_FLAG=-DTEST_LKM
TEST_LKM_FLAG=

${CC_PREFIX}gcc ${LINUX_VER_FLAG} ${SMEP_FLAG} ${TEST_LKM_FLAG} -o exploit exploit.c -lkeyutils
${CC_PREFIX}gcc ${LINUX_VER_FLAG} ${SMEP_FLAG} ${TEST_LKM_FLAG} -o leak leak.c -lkeyutils

cd lkm
make
cd ../
