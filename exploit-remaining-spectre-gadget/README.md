# Exploit remaining spectre gadget

## Summary

- Exploit remaining spectre gadget. (variant1)

- What can we get via exploiting them?
  * Bypass KASLR
  * Infer kernel address of physical map page.

- How to find them?
  * Leverage smatch [1]
  * Revisit CVE list [2]

- Revisit CVE list
  * If there were CVEs which are related to out-of-array access, It might be exploited by spectre-like attack.
  * In other words, We simply search CVEs with some keyword (leak array, leak info, out of array, array index, ...),
    and then exploit them again!!
  * The gadget in the revisited CVE may be suitable for spectre-like attack.
  * This strategy save time of attacker to find target.

- Below Findings have found by "Revisit CVE list" strategy.

- All tests have performed on Ubuntu 16.04 - 4.4.0-62-generic.

## Findings

- Find 3 points, and 2 points are exploitable. I'm believing there are more points.

- leak_pkt_devs.c
  * CVE :  CVE-2010-3437
  * leak symbol :  pkt_devs
  * function :  pkt_find_dev_from_minor
  * file :  drivers/block/pktcdvd.c
  * exploit result :  success

- leak_perf_swevent.c
  * CVE :  CVE-2013-2094
  * leak symbol :  perf_swevent_enabled
  * function :  perf_swevent_init
  * file :  kernel/events/core.c
  * exploit result :  fail

- leak_mac_hwsim.c
  * CVE :  CVE-2018-8087
  * leak symbol :  hwsim_world_regdom_custom
  * function :  hwsim_new_radio_nl
  * file :  drivers/net/wireless/mac80211_hwsim.c
  * exploit result :  success

## Notes

- See comments in code to get details.

## References

- [1] Finding Spectre vulnerabilites with smatch (https://lwn.net/Articles/752408/)
- [2] Linux kernel CVEs (https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html?vendor_id=33)

## Contact

- Jinbum Park <jinb.park7@gmail.com>
